<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE Policies SYSTEM "Policy.ldm.dtd" []>

<!-- Policies for BOOTPOLICY -->

<Policies>
   <Policy name="BOOTPOLICY" type="org.cougaar.core.security.policy.CryptoPolicy">
      <RuleParam name="IncomingSecureMethod">
         <KeySet value="signAndEncrypt"/>
      </RuleParam>
      <RuleParam name="OutgoingSecureMethod">
         <KeySet value="signAndEncrypt"/>
      </RuleParam>
      <RuleParam name="IncomingSymmetricAlgorithm">
         <KeySet value="DES"/>
      </RuleParam>
      <RuleParam name="OutgoingSymmetricAlgorithm">
         <KeySet value="DES"><!-- PKCS#1 is not supported by the Cryptix library --></KeySet>
      </RuleParam>
      <RuleParam name="IncomingAsymmetricAlgorithm">
         <!-- <KeySet value="RSA/ECB/PKCS5Padding"> -->
         <!-- <KeySet value="RSA/ECB/PKCS#1"> (cryptix)-->
         <!-- <KeySet value="RSA/ECB/PKCS1Padding"> -->
         <!-- <KeySet value="ElGamal/ECB/PKCS#1"> -->
         <KeySet value="RSA"/>
      </RuleParam>
      <!-- used to encrypt the session key -->
      <RuleParam name="OutgoingAsymmetricAlgorithm">
         <!-- PKCS#1 is not supported by the Cryptix library -->
         <KeySet value="RSA"/>
      </RuleParam>
      <RuleParam name="IncomingSigningAlgorithm">
         <!-- Example of possible values:          MD2withRSA, MD5withRSA, or SHA1withRSA -->
         <KeySet value="MD5withRSA"/>
      </RuleParam>
      <RuleParam name="OutgoingSigningAlgorithm">
         <KeySet value="MD5withRSA"/>
      </RuleParam>
   </Policy>

 <Policy name="BOOTPOLICY" type="org.cougaar.core.security.policy.AccessControlPolicy">
  <RuleParam name="IncomingMessageAction">
    <KeySet value="">
      <KeyValue key="Criticality0" value="SetAside" />
      <KeyValue key="Criticality1" value="SetAside" />
      <KeyValue key="Criticality2" value="AcceptMessage" />
      <KeyValue key="Criticality3" value="AcceptMessage" />
      <KeyValue key="Criticality4" value="AcceptMessage" />
      <KeyValue key="Criticality5" value="AcceptMessage" />
    </KeySet>
  </RuleParam>

  <RuleParam name="IncomingVerb">
    <KeySet value="*">
	<!--<KeyValue key="TRANSCOM" value="GetLogSupport"/>-->
	<!--<KeyValue key="3-69-ARBN" value="Transport:ProjectSupply"/>-->
	<!--<KeyValue key="703-MSB" value="none"/>-->
    </KeySet>
  </RuleParam>

  <RuleParam name="OutgoingVerb">
    <KeySet value="*">
	<!--<KeyValue key="TRANSCOM" value="GetLogSupport"/>-->
	<!--<KeyValue key="3-69-ARBN" value="Transport:ProjectSupply"/>-->
	<!--<KeyValue key="703-MSB" value="none"/>-->
    </KeySet>
  </RuleParam>

  <RuleParam name="OutgoingAgentAction">
    <KeySet value="AcceptMessage">
      <!-- <KeyValue key="3-69-ARBN" value="SetAside" /> -->
      <!-- <KeyValue key="2-7-INFBN" value="SetAside" /> -->
    </KeySet>
  </RuleParam>

  <RuleParam name="IncomingAgentAction">
    <KeySet value="AcceptMessage">
      <!-- <KeyValue key="3-69-ARBN" value="SetAside" /> -->
      <!-- <KeyValue key="2-7-INFBN" value="SetAside" /> -->
    </KeySet>
  </RuleParam>

    <RuleParam name="IncomingMessageCriticality">
      <KeySet value="3">
      </KeySet>
    </RuleParam>

    <RuleParam name="OutgoingMessageCriticality">
      <KeySet value="3">
      </KeySet>
    </RuleParam>

    <RuleParam name="IncomingMessageIntegrity">
      <KeySet value="3">
      </KeySet>
    </RuleParam>

    <RuleParam name="OutgoingMessageIntegrity">
      <KeySet value="3">
      </KeySet>
    </RuleParam>

   </Policy>

<!-- Requires User database
 -->
  <Policy name="BOOTPOLICY" type="org.cougaar.core.security.policy.LdapUserServicePolicy">
    <RuleParam name="ldapurl">
      <String value="ldap://tea:3890/"/>
    </RuleParam>
    <RuleParam name="user">
      <String value="cn=Manager,dc=couagaar,dc=org"/>
    </RuleParam>
    <RuleParam name="password">
      <String value="secret"/>
    </RuleParam>
    <RuleParam name="user_dn">
      <String value="dc=cougaar,dc=org"/>
    </RuleParam>
    <RuleParam name="role_dn">
      <String value="dc=roles,dc=cougaar,dc=org"/>
    </RuleParam>
    <RuleParam name="user_rdn">
      <String value="uid"/>
    </RuleParam>
    <RuleParam name="role_rdn">
      <String value="cn"/>
    </RuleParam>
    <RuleParam name="userClass">
      <KeySet value="1">
        <Key key="1" value="inetOrgPerson"/>
        <Key key="2" value="cougaarAcct"/>
      </KeySet>
    </RuleParam>
    <RuleParam name="roleClass">
      <KeySet value="1">
        <Key key="1" value="organizationalRole"/>
      </KeySet>
    </RuleParam>
    <RuleParam name="roleAttr">
      <String value="roleOccupant"/>
    </RuleParam>
  </Policy>

<!--
  <Policy name="BOOTPOLICY" type="org.cougaar.core.security.policy.ServletPolicy">
    <RuleParam name="allow-role">
      <KeySet value="ExerciseOne">
        <Key key="/user_admin" value="secure" />
      </KeySet>
    </RuleParam>
    <RuleParam name="auth-constraint">
      <KeySet value="ExerciseOne">
        <Key key="/user_admin*" value="EITHER" />
      </KeySet>
    </RuleParam>
  </Policy>
-->

<!-- BlackboardService read-only filter
-->
  <Policy name="BOOTPOLICY" type="org.cougaar.core.security.policy.BlackboardFiltePolicy">
    <RuleParam name="read-only-rule">
      <KeySet value="org.cougaar.core.security.crypto.ldap.admin.UserAdminServlet">
        <Key key="secure" value="write"/>
        <Key key="tomcat" value="read"/>
        <Key key="disabled" value="none"/>
      </KeySet>
    </RuleParam>
  </Policy>

</Policies>

