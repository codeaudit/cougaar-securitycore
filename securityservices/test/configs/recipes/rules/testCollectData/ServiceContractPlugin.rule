#!/usr/bin/ruby
####################################################
# PolicyInitAgentPlugin

CIP=ENV['CIP']

scPlugin = "org.cougaar.core.security.test.BlackBoardCollectorPlugin"

society.each_agent(true) do |agent|
  agent.add_component do |c|
    c.classname = scPlugin
  end
end

File.open(File.join(CIP, "workspace", "test", "subordinates.rb"), "w") do |rubyFile|
  rubyFile.puts("def installExpectedRelations(rcr)")
  society.each_agent(true) do |agent|
    facetval = agent.get_facet(:superior_org_id)
    if facetval != nil then
      subordinate = agent.name
      superior = facetval
      rubyFile.puts "  rcr.addExpectedRelation(\"#{subordinate}\", \"#{superior}\")"
    end  
  end
  rubyFile.puts("end")
end
