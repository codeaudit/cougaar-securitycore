####################################################
# enclave_ca_config_component.rule

enclaves = 1..4  # there are 4 enclaves...do this once per enclave
society.each_node do |node|
  arg = nil
  if node.name == 'REAR-MGMT-NODE'
    # Enclave 1
    arg = "CN=Enclave1_CA, OU=Enclave1, O=DLA, L=MV, ST=CA, C=US, T=ca"
  elsif node.name == 'FWD-MGMT-NODE'
    # Enclave 2
    arg = "CN=Enclave2_CA, OU=Enclave2, O=DLA, L=MV, ST=CA, C=US, T=ca"
  elsif node.name == 'CONUS-MGMT-NODE'
    # Enclave 3
    arg = "CN=Enclave3_CA, OU=Enclave3, O=DLA, L=MV, ST=CA, C=US, T=ca"
  elsif node.name == 'TRANS-MGMT-NODE'
    # Enclave 4
    arg = "CN=Enclave4_CA, OU=Enclave4, O=DLA, L=MV, ST=CA, C=US, T=ca"
  end

  if arg != nil
    node.agent.add_component do |c|
      c.classname = "org.cougaar.core.security.certauthority.ConfigPlugin"
      c.priority = "HIGH"
      c.insertionpoint = "Node.AgentManager.Agent.SecurityComponent"
      c.add_argument(arg)
      c.add_argument("")
      c.add_argument("sb029:RootCA")
    end
  end
end
