<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE Policies SYSTEM "Policy.ldm.dtd" []>

<!-- Policies for BOOTPOLICY -->

<Policies>
<!-- Requires User database
 -->
  <Policy name="BOOTPOLICY" type="org.cougaar.core.security.policy.LdapUserServicePolicy">
    <RuleParam name="ldapurl">
      <String value="ldap://u068:389/"/>
    </RuleParam>
    <RuleParam name="user">
      <String value="cn=manager,dc=cougaar,dc=org"/>
    </RuleParam>
    <RuleParam name="password">
      <String value="secret"/>
    </RuleParam>
    <RuleParam name="user_dn">
      <String value="dc=cougaar,dc=org"/>
    </RuleParam>
    <RuleParam name="role_dn">
      <String value="dc=roles,dc=cougaar,dc=org"/>
    </RuleParam>
    <RuleParam name="user_rdn">
      <String value="uid"/>
    </RuleParam>
    <RuleParam name="role_rdn">
      <String value="cn"/>
    </RuleParam>
    <RuleParam name="userClass">
      <KeySet value="1">
        <Key key="1" value="inetOrgPerson"/>
        <Key key="2" value="cougaarAcct"/>
      </KeySet>
    </RuleParam>
    <RuleParam name="roleClass">
      <KeySet value="1">
        <Key key="1" value="organizationalRole"/>
      </KeySet>
    </RuleParam>
    <RuleParam name="roleAttr">
      <String value="roleOccupant"/>
    </RuleParam>
  </Policy>

<!--
  <Policy name="BOOTPOLICY" type="org.cougaar.core.security.policy.ServletPolicy">
    <RuleParam name="allow-role">
      <KeySet value="ExerciseOne">
        <Key key="/user_admin" value="secure" />
      </KeySet>
    </RuleParam>
    <RuleParam name="auth-constraint">
      <KeySet value="ExerciseOne">
        <Key key="/user_admin*" value="EITHER" />
      </KeySet>
    </RuleParam>
  </Policy>
-->

<!-- BlackboardService read-only filter
  <Policy name="BOOTPOLICY" type="org.cougaar.core.security.policy.BlackboardFiltePolicy">
    <RuleParam name="read-only-rule">
      <KeySet value="org.cougaar.core.security.crypto.ldap.admin.UserAdminServlet">
        <Key key="secure" value="write"/>
        <Key key="tomcat" value="read"/>
        <Key key="disabled" value="none"/>
      </KeySet>
    </RuleParam>
  </Policy>
-->

</Policies>
