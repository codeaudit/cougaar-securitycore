####################################################
# enclave_crl_providers.rule

society.each_node do |node|
  agentname = ""
  enclave = ""
  if node.name == "REAR-MGMT-NODE"
    enclave = "Rear"
  elsif node.name == "FWD-MGMT-NODE"
    enclave = "Fwd"
  elsif node.name == "CONUS-MGMT-NODE" 
    enclave = "Conus"
  elsif node.name == "TRANS-MGMT-NODE"
    enclave = "Trans"
  end
  if enclave != ""
    agentname = enclave + "EnclaveCrlManager"
  end

  if agentname != ""
    node.add_agent(agentname) do |agent|
      agent.add_component do |c|
        c.classname = "org.cougaar.core.security.crypto.crl.servlet.CRLRegistrationInfo"
        c.add_argument("/CRLRegistrationViewer")
      end
      agent.add_component do |c|
        c.classname = "org.cougaar.core.security.crypto.crl.plugin.CrlAgentRegistrationPlugin"
        c.add_argument("60")
      end
    end
  end
end
